<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TDS - Drivers Management</title>
  <link rel="stylesheet" href="driver.css">
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar" aria-label="Primary">
    <h2>TDS</h2>
    <div class="nav-item">Dashboard</div>
    <div class="nav-item active">Drivers</div>
    <div class="nav-item">Trucks</div>
    <div class="nav-item">Deliveries</div>
    <div class="nav-item">History Reports</div>
  </aside>

  <!-- Main Content -->
  <main class="main">
    <!-- Top Bar -->
    <div class="topbar">
      <span>First_Name</span>
      <span>Last_Name</span>
      <span>Logout</span>
    </div>

    <!-- Content Area -->
    <div class="content">
      <section class="card" aria-labelledby="drivers-title">
        <div class="card-header">
          <h3 id="drivers-title">Drivers Management</h3>
          <form id="addDriverForm" class="field" aria-label="Add driver">
            <label for="driverName" class="sr-only" style="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0;padding:0;margin:-1px;">Driver name</label>
            <input id="driverName" class="input" name="name" type="text" placeholder="Enter driver name" autocomplete="name" required />
            <button type="submit" class="btn">+ Add Driver</button>
          </form>
        </div>
        <div id="driversList" aria-live="polite" aria-relevant="additions removals">
          <!-- Dynamic driver list will show here -->
        </div>
      </section>
    </div>
  </main>

  <script>
    const STORAGE_KEY = 'tds_drivers_v1';

    let drivers = loadDrivers();

    function loadDrivers() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : [];
      } catch (e) {
        return [];
      }
    }

    function saveDrivers() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(drivers));
    }

    function addDriver(name) {
      const trimmed = (name || '').trim();
      if (!trimmed) return;
      const id = (crypto && crypto.randomUUID) ? crypto.randomUUID() : String(Date.now() + Math.random());
      drivers.push({ id, name: trimmed });
      saveDrivers();
      renderDrivers();
    }

    function removeDriver(id) {
      drivers = drivers.filter(d => d.id !== id);
      saveDrivers();
      renderDrivers();
    }

    function renderDrivers() {
      const container = document.getElementById('driversList');
      container.innerHTML = '';
      if (!drivers.length) {
        const p = document.createElement('p');
        p.className = 'muted';
        p.textContent = 'No drivers added yet.';
        container.appendChild(p);
        return;
      }
      const ul = document.createElement('ul');
      ul.className = 'driver-list';
      ul.setAttribute('role', 'list');

      drivers.forEach(driver => {
        const li = document.createElement('li');

        const nameSpan = document.createElement('span');
        nameSpan.textContent = driver.name;

        const actions = document.createElement('div');
        actions.className = 'row-actions';

        const delBtn = document.createElement('button');
        delBtn.type = 'button';
        delBtn.className = 'btn btn-danger';
        delBtn.textContent = 'Delete';
        delBtn.setAttribute('aria-label', `Delete ${driver.name}`);
        delBtn.addEventListener('click', () => removeDriver(driver.id));

        actions.appendChild(delBtn);
        li.appendChild(nameSpan);
        li.appendChild(actions);
        ul.appendChild(li);
      });

      container.appendChild(ul);
    }

    document.getElementById('addDriverForm').addEventListener('submit', function (e) {
      e.preventDefault();
      const input = document.getElementById('driverName');
      addDriver(input.value);
      input.value = '';
      input.focus();
    });

    renderDrivers();
  </script>
</body>
</html>
